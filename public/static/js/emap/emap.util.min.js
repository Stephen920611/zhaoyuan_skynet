window.emap=window.emap||{};emap.util=emap.util||{};emap.util={_earthRadius:6378137,getTwoPointDistance:function(h,g,d,c){var e=this;var f=2*Math.asin(Math.sqrt(Math.pow(Math.sin(d/2),2)+Math.cos(h)*Math.cos(g)*Math.pow(Math.sin(c/2),2)));f=f*e._earthRadius;f=(Math.round(f*10000)/10000).toFixed(2);return f},getDistance:function(h,f){var e=this;var j=e.getRadius(h.lat());var i=e.getRadius(f.lat());var d=j-i;var c=e.getRadius(h.lng())-e.getRadius(f.lng());var g=e.getTwoPointDistance(j,i,d,c);return g},getPointDistance:function(j,g){var m=this;var d=j.lat;var l=j.lng;var c=g.lat;var i=g.lng;var f=m.getRadius(d);var e=m.getRadius(c);var k=f-e;var h=m.getRadius(l)-m.getRadius(i);var n=m.getTwoPointDistance(f,e,k,h);return n},testDistance:function(){var l=this;var k=["37.463353075103946,121.44904680296969","37.4631210095353,121.4501442063719","37.463357929552,121.44636306863727","37.46282090459265,121.45014416147424"];var d=k[0].split(",")[0];var j=k[0].split(",")[1];var c=k[3].split(",")[0];var h=k[3].split(",")[1];var f=l.getRadius(d);var e=l.getRadius(c);var i=f-e;var g=l.getRadius(j)-l.getRadius(h);var m=l.getTwoPointDistance(f,e,i,g);return m},getRadius:function(b){var a=Math.PI;return b*a/180},getPixelPoint:function(e,c){var d=new google.maps.LatLng(e,c);var b=new google.maps.OverlayView();b.draw=function(){};b.setMap(emap.main.getMap());var a=b.getProjection().fromLatLngToContainerPixel(d);return a},getLatLngFromPoint:function(a){var b=new google.maps.OverlayView();b.draw=function(){};b.setMap(emap.main.getMap());var c=b.getProjection().fromContainerPixelToLatLng(a);return c},isPointInPolygon:function(e,g){var k;if(null!=g){var c=g.getPosition();k=c}if(null==e||e.length==0||null==k){return -1}var a=0;var b;var j;var h=null;var d=null;var f=false;h=e[0];for(b=1;b<=e.length;b++){d=e[b%e.length];if(emap.util.isPointOnLine(h,d,k)){f=true}if(k.lng()>Math.min(h.lng(),d.lng())){if(k.lng()<=Math.max(h.lng(),d.lng())){if(k.lat()<=Math.max(h.lat(),d.lat())){if(h.lng()!=d.lng()){j=(k.lng()-h.lng())*(d.lat()-h.lat())/(d.lng()-h.lng())+h.lat();if((h.lat()==d.lat())||(k.lat()<j)||(k.lat()==j)){a++}}}}}h=d}if(f){return true}if(a%2==0){return false}else{return true}},isPointOnLine:function(h,g,f){var b=this;var c,e,a,d;c=f.lat()-h.lat();a=g.lat()-h.lat();e=f.lng()-h.lng();d=g.lng()-h.lng();if(b.FC(c*d-a*e,0)==0){return false}if((Math.min(h.lat(),g.lat())<=f.lat()&&f.lat()<=Math.max(h.lat(),g.lat()))&&(Math.min(h.lng(),g.lng())<=f.lng()&&f.lng()<=Math.max(h.lng(),g.lng()))){return true}else{return false}},FC:function(b,a){if(b-a<0.000002&&b-a>-0.000002){return 1}else{return 0}},circleAreaMeters:function(a){console.log("所选圆形区域面积为：",Math.PI*a*a+"平方米");return Math.PI*a*a},rectAreaMeters:function(c){var k=this;var g=c.getNorthEast();var f=c.getSouthWest();var e=k.getRadius(g.lat());var d=k.getRadius(f.lat());var i=e-d;var h=k.getRadius(g.lng())-k.getRadius(f.lng());var l=k.getTwoPointDistance(e,d,0,h);var j=k.getTwoPointDistance(e,d,i,0);console.log("所选矩形区域面积为：",l*j+"平方米");return l*j},polygonAreaMeters:function(p){var q=this;var b=[];for(var f=0;f<p.length;f++){var m=p[f].lng();var l=p[f].lat();var o=new Array();o.push(Number(m),Number(l));b.push(o)}if(b.length>2){var n=0;var g=2*Math.PI*q._earthRadius/360;for(var f=0;f<b.length;++f){var e=(f+1)%b.length;var k=b[f][0]*g*Math.cos(b[f][1]*(Math.PI/180));var d=b[f][1]*g;var h=b[e][0]*g*Math.cos(b[e][1]*(Math.PI/180));var c=b[e][1]*g;n+=k*c-h*d}console.log("所选多边形区域面积为：",Math.abs(n/2)+"平方米");return Math.abs(n/2)}}};