google.maps.__gjsload__("drawing_impl",function(E){var y=function(H,G){E.E(G,(0,E.t)(H.unbind,H))};var u=function(H,G){function K(S,R,Q,P){var O=E.X("div",H);E.ZQ(O,"left");O.style.lineHeight=0;R={title:R,Of:Q,th:P,padding:[0],Yg:!0};Q=E.X("span");Q.style.display="inline-block";H.style.marginLeft="70px";var N=S||"hand",M=l[N],L=E.qC(J,Q,new E.L(0,M),a);L.style.position="relative";var T=new E.pS(O,Q,S,R);E.G.addListener(T,"active_changed",function(){var U=T.get("active")?D[N]:M;E.pC(L,a,new E.L(0,U))});T.bindTo("value",I,"drawingMode")}var J=E.Vk("drawing"),I=this;K(null,"\u505c\u6b62\u7ed8\u56fe",!0,!G.length);E.E(G,function(L,N){var M=o[L];M&&K(L,M,!1,N==G.length-1)})};var m=function(){};var v=function(H,G,I){this.S=H;this.T=G;this.U=I;E.G.bind(this,"click",this,this.Zl);E.G.bind(this,"mousemove",this,this.Xd);E.G.bind(this,"movestart",this,this.Xl);E.G.bind(this,"move",this,this.Yl);E.G.bind(this,"moveend",this,this.Wl)};var b=function(H){if(!H.j){var G={};E.Fa(G,H.get("options"));null==G.zIndex&&(G.zIndex=H.U());delete G.map;H.j=H.S.O(G)}};var n=function(I,G){I.Xd(G);var K=I.j;K.unbind("map");I.j=null;I.P=true;var J=Date.parse(new Date())/1000+""+parseInt(Math.random()*1000);if(I.S.S()=="circle"){google.maps.event.addListener(K,"rightclick",function(L){$.post("delete.php",{type:"circle",id:J},function(M){});K.setMap(null)})}if(I.S.S()=="rectangle"){google.maps.event.addListener(K,"rightclick",function(L){$.post("delete.php",{type:"tangle",id:J},function(M){});K.setMap(null)});var H=[];H=null}E.G.trigger(I,"overlaycomplete",{type:I.S.S(),overlay:K});E.G.trigger(I,I.S.P(),K);I.O=null;I.P=1};var w=function(){};var e=function(G){this.O=G;this.j=null;E.G.bind(this,"click",this,this.P)};var p=function(H){if(!H.j){var G={};E.Fa(G,H.get("options"));delete G.map;H.j=new E.Kd(G)}};var x=function(H,G,J,I){this.P=H;this.O=G;this.S=J;this.T=I+0.000001;this.j=null;this.na=new E.L(0,0);this.U=new E.L(0,0);this.$=new E.L(0,0);E.G.bind(this,"click",this,this.Gl);E.G.bind(this,"dblclick",this,this.Tn);E.G.bind(this,"mousemove",this,this.Hl);E.G.bind(this,"movestart",this,this.Jl);E.G.bind(this,"move",this,this.Kl);E.G.bind(this,"moveend",this,this.Il)};var f=function(H,G){H.j.Rc.getPath().push(G);H.j.zc.set("anchors",[G])};var q=function(H,G){var I=c(H,G);I?(H.P||2!=I.type||f(H,I.Ra),z(H)):f(H,G)};var c=function(O,N){var M=O.j.Rc.getPath(),L=M.getLength();if(L){var K=O.get("map"),J=K.get("projection"),K=K.__gm.get("zoom"),K=O.T/(1<<K),I=J.fromLatLngToPoint(N,O.na),H=N.lng(),L=M.getAt(L-1),G=new E.J(L.lat(),E.Ja(L.lng(),H-180,H+180),!0),G=J.fromLatLngToPoint(G,O.U);if(Math.abs(I.x-G.x)<=K&&Math.abs(I.y-G.y)<=K){return{type:1,Ra:L}}M=M.getAt(0);H=new E.J(M.lat(),E.Ja(M.lng(),H-180,H+180),!0);J=J.fromLatLngToPoint(H,O.$);if(Math.abs(I.x-J.x)<=K&&Math.abs(I.y-J.y)<=K){return{type:2,Ra:M}}}return null};var g=function(H){var G=H.get("options"),L=new E.I;L.setValues(G);var K=new E.eN(L,H.P),L={};E.Fa(L,G);L.strokeColor=K.get("strokeColor");L.strokeOpacity=K.get("strokeOpacity");L.strokeWeight=K.get("strokeWeight");null==L.zIndex&&(L.zIndex=H.S());delete L.path;delete L.map;var J=new E.Vd(L);J.bindTo("map",H);L.strokeOpacity=K.get("ghostStrokeOpacity");K=new E.dN;K.setValues(L);K.set("anchors",[]);K.bindTo("map",H);var I=null;H.P&&(I={},E.Fa(I,G),I.zIndex=L.zIndex,I.paths=new E.wc([J.getPath()]),delete I.map,I=new E.Ud(I));H.j={Rc:J,Kj:I,zc:K};r(H)};var z=function(H){var G=H.j.Rc;G.unbind("map");var L=H.j.Kj;var I=[];if(H.P){var K=Date.parse(new Date())/1000+""+parseInt(Math.random()*1000);google.maps.event.addListener(L,"rightclick",function(M){$.post("delete.php",{type:"poly",id:K},function(N){});L.setMap(null)})}else{var K=Date.parse(new Date())/1000+""+parseInt(Math.random()*1000);google.maps.event.addListener(G,"rightclick",function(M){$.post("delete.php",{type:"line",id:K},function(N){});G.setMap(null)})}I=null;H.j.zc.unbind("map");H.j.zc.set("map",null);H.j=null;H.set("draggableCursor",H.O);if(G.getPath().getLength()){if(H.P){G.set("map",null);L.set("map",H.get("map"));var J={type:"polygon",overlay:L};E.G.trigger(H,"overlaycomplete",J);E.G.trigger(H,"polygoncomplete",L)}else{J={type:"polyline",overlay:G},E.G.trigger(H,"overlaycomplete",J),E.G.trigger(H,"polylinecomplete",G)}r(H)}else{G.set("map",null)}};var r=function(G){G.set("enablePanning",!!G.j&&G.get("drawPolysWithDrag")&&!G.get("panWhileDrawing"))};var A=function(){};var F=function(H,G){var L,K;H.lat()<G.lat()?(L=H.lat(),K=G.lat()):(L=G.lat(),K=H.lat());var J,I;180>=E.jd(H.lng(),G.lng())?(I=H.lng(),J=G.lng()):(I=G.lng(),J=H.lng());return E.nd(L,I,K,J)};var t=function(){var G=0;return function(){return G++}};var h=function(){var H="click dblclick movestart move moveend panbynow mousewheel".split(" ");E.ok()||H.push("mousemove");H=this.O=d(this,H);this.va=j(this);var G;G="url("+E.Wk+"crosshair.cur)";E.W.O&&(G+=" 7 7");G=G+", crosshair";var J=t();this.T=6+(E.ok()?9:0);this.P={circle:new v(new w,G,J),marker:new e(G),polygon:new x(!0,G,J,this.T),polyline:new x(!1,G,J,this.T),rectangle:new v(new A,G,J)};G=k(this);for(var I in this.P){J=this.P[I],J.bindTo("map",this),J.bindTo("panWhileDrawing",this),J.bindTo("draggingCursor",H),J.bindTo("draggableCursor",G),J.bindTo("enablePanning",H,"panAtEdge"),J.bindTo("options",this,I+"Options"),E.G.forward(J,"overlaycomplete",this),E.G.forward(J,I+"complete",this)}this.P.polygon.bindTo("drawPolysWithDrag",this);this.P.polyline.bindTo("drawPolysWithDrag",this);this.j=null;this.ta=[];this.S=this.U=null;this.oa=0;this.na=this.$=null};var d=function(H,G){var J=new E.$M(G),I=!1;E.E(G,function(K){E.G.addListener(J,K,function(L){"click"!=K&&"dblclick"!=K&&"mousemove"!=K||E.fb(L);if("mousewheel"!=K&&(!I||"mousemove"!=K)){if("mousemove"==K||"move"==K){H.$=K,H.na=L}if(I||!H.get("panWhileDrawing")){"movestart"==K&&(I=!0),"moveend"==K&&(I=!1),"panbynow"==K?H.$&&H.na&&s(H,H.$,H.na):s(H,K,L)}}})});return J};var j=function(H){var G=new E.yv(["map","drawingMode","pegmanDragging"],"active",function(J,I,K){return !!J&&!!I&&!K});G.bindTo("map",H);G.bindTo("drawingMode",H);H.O.bindTo("active",G);return G};var k=function(H){var G=new E.yv(["draggableCursor","panWhileDrawing"],"cursor",function(J,I){return I?null:J});G.bindTo("panWhileDrawing",H);H.O.bindTo("draggableCursor",G,"cursor");return G};var s=function(H,G,L){var K=H.get("map");if(H.j){var J=K.__gm.get("projectionController"),K=K.__gm.get("panes");if(J&&K){L.Ja?(K=L.Ja,J=J.fromContainerPixelToLatLng(K)):(K=E.zl(L,K.floatPane),J=J.fromDivPixelToLatLng(K));var I=H.get("snappingCallback");(I=I&&I(H.j.dh(J)))&&(J=I);if("click"==G){I=E.xj();if(300>=I-H.oa&&H.S&&E.Ka(H.S.x,K.x,H.T)&&E.Ka(H.S.y,K.y,H.T)){return}H.S=K;H.oa=I}E.G.trigger(H.j,G,J,L)}}};var C=function(H){E.R.call(this);var G=new h;G.bindTo("map",H);G.bindTo("drawingMode",H);G.bindTo("panWhileDrawing",H);G.bindTo("markerOptions",H);G.bindTo("polygonOptions",H);G.bindTo("polylineOptions",H);G.bindTo("rectangleOptions",H);G.bindTo("circleOptions",H);G.bindTo("drawPolysWithDrag",H);E.G.forward(G,"overlaycomplete",H);E.G.forward(G,"circlecomplete",H);E.G.forward(G,"markercomplete",H);E.G.forward(G,"polygoncomplete",H);E.G.forward(G,"polylinecomplete",H);E.G.forward(G,"rectanglecomplete",H);this.bindTo("map",H);this.bindTo("drawingControl",H);this.bindTo("drawingControlOptions",H);this.bindTo("drawingMode",H);this.set("snappingCallback",H.get("snappingCallback"));H.bindTo("snappingCallback",this);G.bindTo("snappingCallback",this)};var i=function(G){switch(G){case null:return null;case"Point":return"marker";case"LineString":return"polyline";case"Polygon":return"polygon";default:return null}};E.w(u,E.I);var o={marker:"\u6dfb\u52a0\u70b9",polygon:"\u7ed8\u5236\u591a\u8fb9\u5f62",polyline:"\u7ed8\u5236\u7ebf\u6761",rectangle:"\u7ed8\u5236\u77e9\u5f62",circle:"\u7ed8\u5236\u5706\u5f62"},a=new E.M(32,32),D={hand:288,marker:224,polygon:192,polyline:256,rectangle:96,circle:0},l={hand:160,marker:352,polygon:128,polyline:64,rectangle:32,circle:320};E.w(m,E.I);E.w(v,m);E.m=v.prototype;E.m.dh=function(G){b(this);this.Xd(G);return{latLng:G,overlay:this.j}};E.m.active_changed=function(){if(this.get("active")){this.set("draggableCursor",this.T),this.set("draggingCursor","")}else{var G=this.j;G&&(G.unbind("map"),G.set("map",null),this.j=null);this.O=null;this.P=!1}};E.m.Xd=function(G){this.j&&(this.O?(this.j.get("map")||this.j.bindTo("map",this),this.S.j(this.j,this.O,G)):this.S.j(this.j,G))};E.m.Zl=function(G){this.O?n(this,G):(b(this),this.O=G,this.Xd(G),this.P=!0)};E.m.Xl=function(H,G){this.P||(this.set("draggingCursor",this.T),this.set("enablePanning",!0),b(this),this.O=H,this.Xd(H),E.GC(G))};E.m.Yl=function(H,G){this.P||(this.Xd(H),E.GC(G))};E.m.Wl=function(H,G){this.P||(this.set("draggingCursor",""),this.set("enablePanning",!1),n(this,H),E.GC(G))};w.prototype.O=function(G){return new E.cg(G)};w.prototype.j=function(H,G,K){H.set("center",G);var J=0,I=H.get("map");I&&K&&(J=I.__gm.get("mapType"),J=E.SA(G,K,J&&J.radius));H.set("radius",J)};w.prototype.S=E.na("circle");w.prototype.P=E.na("circlecomplete");E.w(e,m);e.prototype.dh=function(G){p(this);this.j.setPosition(G);return{latLng:G,overlay:this.j}};e.prototype.active_changed=function(){this.get("active")&&this.set("draggableCursor",this.O)};e.prototype.P=function(G){p(this);E.G.trigger(this,"overlaycomplete",{type:"marker",overlay:this.j});E.G.trigger(this,"markercomplete",this.j);this.j=null};E.w(x,m);E.m=x.prototype;E.m.dh=function(G){this.j&&this.j.Rc||g(this);return{latLng:G,overlay:this.j.Kj||this.j.Rc}};E.m.active_changed=function(){this.get("active")?this.set("draggableCursor",this.O):this.j&&this.j.Rc&&z(this)};E.m.Gl=function(G){this.j?q(this,G):(g(this),f(this,G))};E.m.Tn=function(){this.j&&1<this.j.Rc.getPath().getLength()&&z(this)};E.m.Hl=function(H){var G=H;this.j&&(H=c(this,H),this.set("draggableCursor",H?"pointer":this.O),H&&(G=H.Ra),this.j.zc.set("freeVertexPosition",G))};E.m.Jl=function(H,G){this.get("drawPolysWithDrag")&&(this.j||g(this),this.j.Rc.getPath().getLength()||f(this,H),this.set("draggingCursor",this.O),E.GC(G))};E.m.Kl=function(H,G){this.j&&this.get("drawPolysWithDrag")&&(this.j.zc.set("freeVertexPosition",H),E.GC(G))};E.m.Il=function(H,G){this.get("drawPolysWithDrag")&&(this.j&&(q(this,H),this.set("draggingCursor","")),this.j&&this.j.zc.set("freeVertexPosition",null),E.GC(G))};E.m.drawPolysWithDrag_changed=x.prototype.panWhileDrawing_changed=function(){r(this)};A.prototype.O=function(G){return new E.dg(G)};A.prototype.j=function(H,G,I){H.set("bounds",F(G,I||G))};A.prototype.S=E.na("rectangle");A.prototype.P=E.na("rectanglecomplete");E.w(h,E.I);h.prototype.map_changed=function(){var H=this.get("map"),G=this.va,J=this.O;if(H){var I=H.__gm;this.bindTo("mouseEventTarget",I);G.bindTo("pegmanDragging",I);J.bindTo("draggable",H);J.bindTo("scrollwheel",H);this.U=E.G.forward(J,"panbynow",I)}else{this.unbind("mouseEventTarget"),this.set("mouseEventTarget",null),G.unbind("pegmanDragging"),J.unbind("draggable"),J.unbind("scrollwheel"),this.U&&(E.G.removeListener(this.U),this.U=null)}};h.prototype.mouseEventTarget_changed=function(){var H=["offset","panes","projectionTopLeft","size"];y(this.O,H);var G=this.ta;E.E(G,E.G.removeListener);G.length=0;var K=this.get("mouseEventTarget");if(K){var J=this.O,I=this.get("map");E.eD(J,H,I.__gm);E.E(["movestart","move","moveend"],function(L){var M=E.G.addListener(J,L,function(N){E.Ql(N)||E.G.trigger(K,L,N)});G.push(M)});E.G.forward(J,"mousewheel",K)}};h.prototype.drawingMode_changed=function(){this.j&&this.j.set("active",!1);this.O.set("panAtEdge",!1);var G=this.get("drawingMode");(this.j=this.P[G])&&this.j.set("active",!0)};E.w(C,E.R);C.prototype.map_changed=function(){var G=this.get("map");G?(G=G.__gm,this.bindTo("layoutManager",G),G.set("snappingCallback",this.get("snappingCallback")),this.bindTo("snappingCallback",G)):(this.unbind("layoutManager"),this.set("layoutManager",null),this.unbind("snappingCallback"))};C.prototype.layoutManager_changed=C.prototype.drawingControl_changed=C.prototype.drawingControlOptions_changed=function(){this.Ba()};C.prototype.Ia=function(){this.j&&(this.P.O(this.j),E.Vf(this.j),this.j=null,this.O.unbindAll(),this.O=null);if((this.P=this.get("layoutManager"))&&0!=this.get("drawingControl")){var H=this.get("drawingControlOptions")||{},G=H.drawingModes||B,I=window.document.createElement("div");E.NC(I);I.style.margin=E.T(5);E.Jk(I,10);this.j=I;this.O=new u(this.j,G);this.O.bindTo("drawingMode",this);this.P.j(this.j,H.position||1,!1,0.25)}};var B=["marker","polyline","rectangle","circle","polygon"];E.nc("drawing_impl",{Mk:C,bo:function(H){var G=new E.I,L=new E.yv(["dataDrawingMode"],"drawingManagerMode",i);L.bindTo("dataDrawingMode",H,"drawingMode");var K=new E.yv(["styleOrStylingFunction"],"style",function(M){return"function"===typeof M?M(new E.pc):M});K.bindTo("styleOrStylingFunction",H,"style");var J=new E.yv(["controls","controlPosition"],"drawingControlOptions",function(N,M){return{drawingModes:E.Na(N,i),position:M}});J.bindTo("controls",H);J.bindTo("controlPosition",H);var I=new E.yv(["controls"],"drawingControl",function(M){return !!M});I.bindTo("controls",H);G.bindTo("map",H);G.bindTo("drawingMode",L,"drawingManagerMode");G.bindTo("markerOptions",K,"style");G.bindTo("polylineOptions",K,"style");G.bindTo("polygonOptions",K,"style");G.bindTo("drawingControlOptions",J);G.bindTo("drawingControl",I);E.G.addListener(G,"overlaycomplete",function(M){M=M.overlay;var O=E.aD([M]),N=H.get("featureFactory"),O=N?N(O):new E.pc({geometry:O});H.add(O);M.set("map",null)});new C(G);E.jD(H,function(){var M=H.get("map");M&&E.Y(M,"Le")})}})});